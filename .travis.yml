os: linux
dist: focal
addons:
  apt:
    packages:
    - valgrind
    - doxygen
    - cppcheck
    - gcovr
    - git
    - cmake
    - clang
    - gcc
    - g++
    - python3-pip
install:
- pip3 install cpplint
jobs:
  include:
  - name: memory_checks
    script: "./scripts/checks.sh"
  - name: static_analyze
    script: "./scripts/static_analyze.sh"
  - name: linters
    script: "./scripts/linters.sh"
  - name: unit_tests
    script: "./scripts/tests.sh"
  - name: coverage
    script: "./scripts/coverage.sh"


 deploy:
   provider: releases
   api-key:
     secure: "E8Lm38UwCsU2X8kogZawLvq7zGYFJvkBwlAhAKSBrNmocNEyVQnn5UZ2qnw+wLfI6sLuL/lXbGuY88g8riJA6qdO+uZ4jUvMh/gsERqRxyEhkxPHEOUW3+cCLFBqqoXrEZ4RDfAlvgc73/KOWOc2UjYy0+mPb8M6TalHE/FgrIKmwsGkKKXIbV+ESVKhYz1JlzTURA8tQttU4/QkZIVy4hOAkMWOR3RWpm6sCGf32oWJnapJebbtp0jcPYaNOyVRVv9pWwqtxYelXsHAlYXk1IvCftHDofJsny4bABCA72eaVfYMQOOp8CYlvYKq60Fol+pk6NvLJSdaLR7A3Zkkqmsez8CHMGDN65TEo+bd2SDSrM4CYGOb0Eb1i2FE/XQ+j/MGy6NFSoRQOnBGIIx7dGaqOi2/sFZKI21XkwWOTI3WByJDZ1jl0vPbweEGarg8ehoj5A1OE84PD8lzQ9NILKSsbPlSskoAH4bpM6OZ3zQ6jYYUbx3k+IrKW72VlLwl5fOd3FQ5DQLjR17KQwK18qOPBI/oM4uQUMD/qyNE9dv/O8iSWALpGxrkjUMdCndfXTMKfTi+hPBxAfKvp9/sFkSqrTLALqbisTQ64OyriAD2V/8eQc0DkXBbwVbH+ABSGuq3ypX/oM+Ix1derG1bqqu/GMH2SsucCIuOpmj4PrM="
   user: Kam1runetzLabs
   file: static-analyze-report-src/*
   file: static-analyze-report-tests/*
   file: coverage-report/*
   tag_name: "$TRAVIS_TAG"
   target_commitish: "$TRAVIS_COMMIT"
   name: "$TRAVIS_TAG"
   skip_cleanup: true
   overwrite: true
   on:
     branch: development

notifications:
  email: false

before_deploy:
- git config --local user.name "Kam1runetz"
- git config --local user.email "notsoserious2017@gmail.com"
- export TRAVIS_TAG="build-$TRAVIS_BUILD_NUMBER"
- echo "Tagging commit ${TRAVIS_COMMIT} with tag ${TRAVIS_TAG}"
- git tag "$TRAVIS_TAG" "$TRAVIS_COMMIT"

branches:
  except:
  - master
